{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{supabase}from'../client';import'./DetailView.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const DetailView=()=>{const{id}=useParams();const[detail,setDetail]=useState(null);const[likeCount,setLikeCount]=useState(0);const[comments,setComments]=useState([]);const[newComment,setNewComment]=useState('');useEffect(()=>{const fetchComments=async()=>{const{data,error}=await supabase.from('Comments').select('*').eq('postid',id);if(error){console.error('Error fetching comments:',error);}else{setComments(data);}};const fetchDetail=async()=>{const{data,error}=await supabase.from('Manure Posts').select('*').eq('id',id).single();if(error){console.error('Error fetching details:',error);}else{setDetail(data);setLikeCount(data.likes);}};fetchComments();fetchDetail();},[id]);// Only re-run effect when the 'id' changes\nconst handleLikeClick=async()=>{const newLikeCount=likeCount+1;setLikeCount(newLikeCount);await supabase.from('Manure Posts').update({likes:newLikeCount}).eq('id',id);};const handleSubmitComment=async e=>{e.preventDefault();if(!newComment.trim())return;await supabase.from('Comments').insert([{postid:id,content:newComment}]);setNewComment('');// Re-fetch comments after adding a new one\nconst{data,error}=await supabase.from('Comments').select('*').eq('postid',id);if(error){console.error('Error fetching updated comments:',error);}else{setComments(data);}};const handleEditClick=()=>{window.location.href=`/edit/${id}`;};const handleDeleteClick=async()=>{await supabase.from('Manure Posts').delete().eq('id',id);window.location.href='/';};if(!detail)return/*#__PURE__*/_jsx(\"div\",{className:\"DetailView Loading\",children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"DetailView\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"editButton\",onClick:handleEditClick,children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"editButton\",onClick:handleDeleteClick,style:{backgroundColor:'darkred'},children:\"Delete\"}),/*#__PURE__*/_jsx(\"h1\",{children:detail.name}),/*#__PURE__*/_jsx(\"h2\",{children:detail.type}),/*#__PURE__*/_jsx(\"p\",{children:detail.description}),/*#__PURE__*/_jsxs(\"button\",{className:\"likeButton\",onClick:handleLikeClick,children:[\"\\uD83D\\uDEBD \",likeCount]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Comments\"}),/*#__PURE__*/_jsx(\"ul\",{children:comments.map(comment=>/*#__PURE__*/_jsx(\"li\",{children:comment.content},comment.id))}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitComment,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Add a comment...\",style:{width:'300px',height:'30px'}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Post Comment\"})]})]})]});};export default DetailView;","map":{"version":3,"names":["React","useEffect","useState","useParams","supabase","DetailView","id","detail","setDetail","likeCount","setLikeCount","comments","setComments","newComment","setNewComment","fetchComments","data","error","from","select","eq","console","fetchDetail","single","likes","handleLikeClick","newLikeCount","update","handleSubmitComment","e","preventDefault","trim","insert","postid","content","handleEditClick","window","location","href","handleDeleteClick","delete","backgroundColor","name","type","description","map","comment","target","value","width","height"],"sources":["C:/Users/aaron/OneDrive/Desktop/Cabinent/Content/Code/Full-Stack-Project-8/src/components/DetailView.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { supabase } from '../client';\r\nimport './DetailView.css';\r\n\r\nconst DetailView = () => {\r\n    const { id } = useParams();\r\n    const [detail, setDetail] = useState(null);\r\n    const [likeCount, setLikeCount] = useState(0); \r\n    const [comments, setComments] = useState([]); \r\n    const [newComment, setNewComment] = useState(''); \r\n\r\n    useEffect(() => {\r\n        const fetchComments = async () => {\r\n            const { data, error } = await supabase\r\n                .from('Comments')\r\n                .select('*')\r\n                .eq('postid', id);\r\n\r\n            if (error) {\r\n                console.error('Error fetching comments:', error);\r\n            } else {\r\n                setComments(data);\r\n            }\r\n        };\r\n\r\n        const fetchDetail = async () => {\r\n            const { data, error } = await supabase\r\n                .from('Manure Posts')\r\n                .select('*')\r\n                .eq('id', id)\r\n                .single();\r\n\r\n            if (error) {\r\n                console.error('Error fetching details:', error);\r\n            } else {\r\n                setDetail(data);\r\n                setLikeCount(data.likes); \r\n            }\r\n        };\r\n\r\n        fetchComments();\r\n        fetchDetail();\r\n    }, [id]); // Only re-run effect when the 'id' changes\r\n\r\n    const handleLikeClick = async () => {\r\n        const newLikeCount = likeCount + 1; \r\n        setLikeCount(newLikeCount); \r\n\r\n        await supabase\r\n            .from('Manure Posts')\r\n            .update({ likes: newLikeCount })\r\n            .eq('id', id);\r\n    };\r\n\r\n    const handleSubmitComment = async (e) => {\r\n        e.preventDefault();\r\n        if (!newComment.trim()) return;\r\n\r\n        await supabase\r\n            .from('Comments')\r\n            .insert([{ postid: id, content: newComment }]);\r\n\r\n        setNewComment('');\r\n        \r\n        // Re-fetch comments after adding a new one\r\n        const { data, error } = await supabase\r\n            .from('Comments')\r\n            .select('*')\r\n            .eq('postid', id);\r\n        if (error) {\r\n            console.error('Error fetching updated comments:', error);\r\n        } else {\r\n            setComments(data);\r\n        }\r\n    };\r\n\r\n    const handleEditClick = () => {\r\n        window.location.href = `/edit/${id}`;\r\n    };\r\n\r\n    const handleDeleteClick = async () => {\r\n        await supabase\r\n            .from('Manure Posts')\r\n            .delete()\r\n            .eq('id', id);\r\n        \r\n        window.location.href = '/';\r\n    };\r\n\r\n    if (!detail) return <div className=\"DetailView Loading\">Loading...</div>;\r\n\r\n    return (\r\n        <div className=\"DetailView\">\r\n            <button className=\"editButton\" onClick={handleEditClick}>Edit</button>\r\n            <button className=\"editButton\" onClick={handleDeleteClick} style={{ backgroundColor: 'darkred' }}>Delete</button>\r\n            <h1>{detail.name}</h1>\r\n            <h2>{detail.type}</h2>\r\n            <p>{detail.description}</p>\r\n            <button className=\"likeButton\" onClick={handleLikeClick}>\r\n                ðŸš½ {likeCount}\r\n            </button>\r\n            <div>\r\n                <h3>Comments</h3>\r\n                <ul>\r\n                    {comments.map(comment => (\r\n                        <li key={comment.id}>{comment.content}</li>\r\n                    ))}\r\n                </ul>\r\n                <form onSubmit={handleSubmitComment}>\r\n                    <input\r\n                        type=\"text\"\r\n                        value={newComment}\r\n                        onChange={e => setNewComment(e.target.value)}\r\n                        placeholder=\"Add a comment...\"\r\n                        style={{\r\n                            width: '300px', \r\n                            height: '30px', \r\n                        }}\r\n                    />\r\n                    <button type=\"submit\">Post Comment</button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default DetailView;\r\n"],"mappings":"AAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,SAAT,KAA0B,kBAA1B,CACA,OAASC,QAAT,KAAyB,WAAzB,CACA,MAAO,kBAAP,C,wFAEA,KAAMC,WAAU,CAAG,IAAM,CACrB,KAAM,CAAEC,EAAF,EAASH,SAAS,EAAxB,CACA,KAAM,CAACI,MAAD,CAASC,SAAT,EAAsBN,QAAQ,CAAC,IAAD,CAApC,CACA,KAAM,CAACO,SAAD,CAAYC,YAAZ,EAA4BR,QAAQ,CAAC,CAAD,CAA1C,CACA,KAAM,CAACS,QAAD,CAAWC,WAAX,EAA0BV,QAAQ,CAAC,EAAD,CAAxC,CACA,KAAM,CAACW,UAAD,CAAaC,aAAb,EAA8BZ,QAAQ,CAAC,EAAD,CAA5C,CAEAD,SAAS,CAAC,IAAM,CACZ,KAAMc,cAAa,CAAG,SAAY,CAC9B,KAAM,CAAEC,IAAF,CAAQC,KAAR,EAAkB,KAAMb,SAAQ,CACjCc,IADyB,CACpB,UADoB,EAEzBC,MAFyB,CAElB,GAFkB,EAGzBC,EAHyB,CAGtB,QAHsB,CAGZd,EAHY,CAA9B,CAKA,GAAIW,KAAJ,CAAW,CACPI,OAAO,CAACJ,KAAR,CAAc,0BAAd,CAA0CA,KAA1C,EACH,CAFD,IAEO,CACHL,WAAW,CAACI,IAAD,CAAX,CACH,CACJ,CAXD,CAaA,KAAMM,YAAW,CAAG,SAAY,CAC5B,KAAM,CAAEN,IAAF,CAAQC,KAAR,EAAkB,KAAMb,SAAQ,CACjCc,IADyB,CACpB,cADoB,EAEzBC,MAFyB,CAElB,GAFkB,EAGzBC,EAHyB,CAGtB,IAHsB,CAGhBd,EAHgB,EAIzBiB,MAJyB,EAA9B,CAMA,GAAIN,KAAJ,CAAW,CACPI,OAAO,CAACJ,KAAR,CAAc,yBAAd,CAAyCA,KAAzC,EACH,CAFD,IAEO,CACHT,SAAS,CAACQ,IAAD,CAAT,CACAN,YAAY,CAACM,IAAI,CAACQ,KAAN,CAAZ,CACH,CACJ,CAbD,CAeAT,aAAa,GACbO,WAAW,GACd,CA/BQ,CA+BN,CAAChB,EAAD,CA/BM,CAAT,CA+BU;AAEV,KAAMmB,gBAAe,CAAG,SAAY,CAChC,KAAMC,aAAY,CAAGjB,SAAS,CAAG,CAAjC,CACAC,YAAY,CAACgB,YAAD,CAAZ,CAEA,KAAMtB,SAAQ,CACTc,IADC,CACI,cADJ,EAEDS,MAFC,CAEM,CAAEH,KAAK,CAAEE,YAAT,CAFN,EAGDN,EAHC,CAGE,IAHF,CAGQd,EAHR,CAAN,CAIH,CARD,CAUA,KAAMsB,oBAAmB,CAAG,KAAOC,EAAP,EAAa,CACrCA,CAAC,CAACC,cAAF,GACA,GAAI,CAACjB,UAAU,CAACkB,IAAX,EAAL,CAAwB,OAExB,KAAM3B,SAAQ,CACTc,IADC,CACI,UADJ,EAEDc,MAFC,CAEM,CAAC,CAAEC,MAAM,CAAE3B,EAAV,CAAc4B,OAAO,CAAErB,UAAvB,CAAD,CAFN,CAAN,CAIAC,aAAa,CAAC,EAAD,CAAb,CAEA;AACA,KAAM,CAAEE,IAAF,CAAQC,KAAR,EAAkB,KAAMb,SAAQ,CACjCc,IADyB,CACpB,UADoB,EAEzBC,MAFyB,CAElB,GAFkB,EAGzBC,EAHyB,CAGtB,QAHsB,CAGZd,EAHY,CAA9B,CAIA,GAAIW,KAAJ,CAAW,CACPI,OAAO,CAACJ,KAAR,CAAc,kCAAd,CAAkDA,KAAlD,EACH,CAFD,IAEO,CACHL,WAAW,CAACI,IAAD,CAAX,CACH,CACJ,CApBD,CAsBA,KAAMmB,gBAAe,CAAG,IAAM,CAC1BC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAwB,SAAQhC,EAAG,EAAnC,CACH,CAFD,CAIA,KAAMiC,kBAAiB,CAAG,SAAY,CAClC,KAAMnC,SAAQ,CACTc,IADC,CACI,cADJ,EAEDsB,MAFC,GAGDpB,EAHC,CAGE,IAHF,CAGQd,EAHR,CAAN,CAKA8B,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuB,GAAvB,CACH,CAPD,CASA,GAAI,CAAC/B,MAAL,CAAa,mBAAO,YAAK,SAAS,CAAC,oBAAf,wBAAP,CAEb,mBACI,aAAK,SAAS,CAAC,YAAf,wBACI,eAAQ,SAAS,CAAC,YAAlB,CAA+B,OAAO,CAAE4B,eAAxC,kBADJ,cAEI,eAAQ,SAAS,CAAC,YAAlB,CAA+B,OAAO,CAAEI,iBAAxC,CAA2D,KAAK,CAAE,CAAEE,eAAe,CAAE,SAAnB,CAAlE,oBAFJ,cAGI,oBAAKlC,MAAM,CAACmC,IAAZ,EAHJ,cAII,oBAAKnC,MAAM,CAACoC,IAAZ,EAJJ,cAKI,mBAAIpC,MAAM,CAACqC,WAAX,EALJ,cAMI,gBAAQ,SAAS,CAAC,YAAlB,CAA+B,OAAO,CAAEnB,eAAxC,2BACQhB,SADR,GANJ,cASI,oCACI,gCADJ,cAEI,oBACKE,QAAQ,CAACkC,GAAT,CAAaC,OAAO,eACjB,oBAAsBA,OAAO,CAACZ,OAA9B,EAASY,OAAO,CAACxC,EAAjB,CADH,CADL,EAFJ,cAOI,cAAM,QAAQ,CAAEsB,mBAAhB,wBACI,cACI,IAAI,CAAC,MADT,CAEI,KAAK,CAAEf,UAFX,CAGI,QAAQ,CAAEgB,CAAC,EAAIf,aAAa,CAACe,CAAC,CAACkB,MAAF,CAASC,KAAV,CAHhC,CAII,WAAW,CAAC,kBAJhB,CAKI,KAAK,CAAE,CACHC,KAAK,CAAE,OADJ,CAEHC,MAAM,CAAE,MAFL,CALX,EADJ,cAWI,eAAQ,IAAI,CAAC,QAAb,0BAXJ,GAPJ,GATJ,GADJ,CAiCH,CAxHD,CA0HA,cAAe7C,WAAf"},"metadata":{},"sourceType":"module"}