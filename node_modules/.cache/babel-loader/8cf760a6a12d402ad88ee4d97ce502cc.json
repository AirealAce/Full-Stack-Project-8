{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/aaron/OneDrive/Desktop/Cabinent/Content/Code/Github/CAP Full Stack/Final Project/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/aaron/OneDrive/Desktop/Cabinent/Content/Code/Github/CAP Full Stack/Final Project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/aaron/OneDrive/Desktop/Cabinent/Content/Code/Github/CAP Full Stack/Final Project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{supabase}from'../client';import'./DetailView.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DetailView=function DetailView(){var _useParams=useParams(),id=_useParams.id;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),detail=_useState2[0],setDetail=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),likeCount=_useState4[0],setLikeCount=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),comments=_useState6[0],setComments=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),newComment=_useState8[0],setNewComment=_useState8[1];var fetchComments=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$supabase$from$,data,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return supabase.from('Comments').select('*').eq('postid',id);case 2:_yield$supabase$from$=_context.sent;data=_yield$supabase$from$.data;error=_yield$supabase$from$.error;if(error){console.error('Error fetching comments:',error);}else{setComments(data);}case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchComments(){return _ref.apply(this,arguments);};}();useEffect(function(){var fetchDetail=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$supabase$from$2,data,error;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return supabase.from('Manure Posts').select('*').eq('id',id).single();case 2:_yield$supabase$from$2=_context2.sent;data=_yield$supabase$from$2.data;error=_yield$supabase$from$2.error;if(error){console.error('Error fetching details:',error);}else{setDetail(data);setLikeCount(data.likes);}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchDetail(){return _ref2.apply(this,arguments);};}();fetchComments();fetchDetail();},[id]);var handleLikeClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var newLikeCount;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:newLikeCount=likeCount+1;setLikeCount(newLikeCount);_context3.next=4;return supabase.from('Manure Posts').update({likes:newLikeCount}).eq('id',id);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function handleLikeClick(){return _ref3.apply(this,arguments);};}();var handleSubmitComment=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();if(newComment.trim()){_context4.next=3;break;}return _context4.abrupt(\"return\");case 3:_context4.next=5;return supabase.from('Comments').insert([{postid:id,content:newComment}]);case 5:setNewComment('');fetchComments();case 7:case\"end\":return _context4.stop();}}},_callee4);}));return function handleSubmitComment(_x){return _ref4.apply(this,arguments);};}();var handleEditClick=function handleEditClick(){window.location.href=\"/edit/\".concat(id);};var handleDeleteClick=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return supabase.from('Manure Posts').delete().eq('id',id);case 2:window.location.href='/';case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function handleDeleteClick(){return _ref5.apply(this,arguments);};}();if(!detail)return/*#__PURE__*/_jsx(\"div\",{className:\"DetailView Loading\",children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"DetailView\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"editButton\",onClick:handleEditClick,children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"editButton\",onClick:handleDeleteClick,style:{backgroundColor:'darkred'},children:\"Delete\"}),/*#__PURE__*/_jsx(\"h1\",{children:detail.name}),/*#__PURE__*/_jsx(\"h2\",{children:detail.type}),/*#__PURE__*/_jsx(\"p\",{children:detail.description}),/*#__PURE__*/_jsxs(\"button\",{className:\"likeButton\",onClick:handleLikeClick,children:[\"\\uD83D\\uDEBD \",likeCount]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Comments\"}),/*#__PURE__*/_jsx(\"ul\",{children:comments.map(function(comment){return/*#__PURE__*/_jsx(\"li\",{children:comment.content},comment.id);})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitComment,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newComment,onChange:function onChange(e){return setNewComment(e.target.value);},placeholder:\"Add a comment...\",style:{width:'300px',height:'30px'}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Post Comment\"})]})]})]});};export default DetailView;","map":{"version":3,"names":["React","useEffect","useState","useParams","supabase","DetailView","id","detail","setDetail","likeCount","setLikeCount","comments","setComments","newComment","setNewComment","fetchComments","from","select","eq","data","error","console","fetchDetail","single","likes","handleLikeClick","newLikeCount","update","handleSubmitComment","e","preventDefault","trim","insert","postid","content","handleEditClick","window","location","href","handleDeleteClick","delete","backgroundColor","name","type","description","map","comment","target","value","width","height"],"sources":["C:/Users/aaron/OneDrive/Desktop/Cabinent/Content/Code/Github/CAP Full Stack/Final Project/client/src/components/DetailView.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { supabase } from '../client';\r\nimport './DetailView.css'; \r\n\r\nconst DetailView = () => {\r\n    const { id } = useParams();\r\n    const [detail, setDetail] = useState(null);\r\n    const [likeCount, setLikeCount] = useState(0); \r\n    const [comments, setComments] = useState([]); \r\n    const [newComment, setNewComment] = useState(''); \r\n\r\n    const fetchComments = async () => {\r\n        const { data, error } = await supabase\r\n            .from('Comments')\r\n            .select('*')\r\n            .eq('postid', id);\r\n\r\n        if (error) {\r\n            console.error('Error fetching comments:', error);\r\n        } else {\r\n            setComments(data);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        const fetchDetail = async () => {\r\n            const { data, error } = await supabase\r\n                .from('Manure Posts')\r\n                .select('*')\r\n                .eq('id', id)\r\n                .single();\r\n\r\n            if (error) {\r\n                console.error('Error fetching details:', error);\r\n            } else {\r\n                setDetail(data);\r\n                setLikeCount(data.likes); \r\n            }\r\n        };\r\n\r\n        fetchComments();\r\n        fetchDetail();\r\n    }, [id]);\r\n\r\n    const handleLikeClick = async () => {\r\n        const newLikeCount = likeCount + 1; \r\n        setLikeCount(newLikeCount); \r\n\r\n        await supabase\r\n            .from('Manure Posts')\r\n            .update({ likes: newLikeCount })\r\n            .eq('id', id);\r\n    };\r\n\r\n    const handleSubmitComment = async (e) => {\r\n        e.preventDefault();\r\n        if (!newComment.trim()) return;\r\n\r\n        await supabase\r\n            .from('Comments')\r\n            .insert([{ postid: id, content: newComment }]);\r\n\r\n        setNewComment('');\r\n        \r\n        fetchComments();\r\n    };\r\n\r\n    const handleEditClick = () => {\r\n        window.location.href = `/edit/${id}`;\r\n    };\r\n\r\n    const handleDeleteClick = async () => {\r\n        await supabase\r\n            .from('Manure Posts')\r\n            .delete()\r\n            .eq('id', id);\r\n        \r\n        window.location.href = '/';\r\n    };\r\n\r\n    if (!detail) return <div className=\"DetailView Loading\">Loading...</div>;\r\n\r\n    return (\r\n        <div className=\"DetailView\">\r\n            <button className=\"editButton\" onClick={handleEditClick}>Edit</button>\r\n            <button className=\"editButton\" onClick={handleDeleteClick} style={{ backgroundColor: 'darkred' }}>Delete</button>\r\n            <h1>{detail.name}</h1>\r\n            <h2>{detail.type}</h2>\r\n            <p>{detail.description}</p>\r\n            <button className=\"likeButton\" onClick={handleLikeClick}>\r\n                ðŸš½ {likeCount}\r\n            </button>\r\n            <div>\r\n                <h3>Comments</h3>\r\n                <ul>\r\n                    {comments.map(comment => (\r\n                        <li key={comment.id}>{comment.content}</li>\r\n                    ))}\r\n                </ul>\r\n                <form onSubmit={handleSubmitComment}>\r\n                    <input\r\n                        type=\"text\"\r\n                        value={newComment}\r\n                        onChange={e => setNewComment(e.target.value)}\r\n                        placeholder=\"Add a comment...\"\r\n                        style={{\r\n                            width: '300px', \r\n                            height: '30px', \r\n                        }}\r\n                    />\r\n                    <button type=\"submit\">Post Comment</button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default DetailView;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}